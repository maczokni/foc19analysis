"0","data <- data %>% mutate(
  whochangedff = case_when(foc19_w2 == ""Unworried"" & foc19_w3 == ""Unworried"" ~ ""Stayed Unworried"",
                           foc19_w2 == ""Coping"" & foc19_w3 == ""Coping"" ~ ""Stayed Coping"",
                           foc19_w2 == ""Struggling"" & foc19_w3 == ""Struggling"" ~ ""Stayed Struggling"",
                           foc19_w2 == ""Unworried"" & foc19_w3 == ""Coping"" ~ ""Unworried to Coping"",
                           foc19_w2 == ""Unworried"" & foc19_w3 == ""Struggling"" ~ ""Unworried to Struggling"", 
                           foc19_w2 == ""Coping"" & foc19_w3 == ""Unworried"" ~ ""Coping to Unworried"",
                           foc19_w2 == ""Coping"" & foc19_w3 == ""Struggling"" ~ ""Coping to Struggling"",
                           foc19_w2 == ""Struggling"" & foc19_w3 == ""Unworried"" ~ ""Struggling to Unworried"",
                           foc19_w2 == ""Struggling"" & foc19_w3 == ""Coping"" ~ ""Struggling to Coping""), 
  stayedsame = case_when(
    grepl(""Stayed"", whochangedff) ~""stayed"", 
    grepl("" to "", whochangedff)~""changed"",
    TRUE ~ NA_character_))
data <- data %>% mutate(
  whochangedff = case_when(foc19_w2 == ""Unworried"" & foc19_w3 == ""Unworried"" ~ ""Stayed Unworried"",
                           foc19_w2 == ""Coping"" & foc19_w3 == ""Coping"" ~ ""Stayed Coping"",
                           foc19_w2 == ""Struggling"" & foc19_w3 == ""Struggling"" ~ ""Stayed Struggling"",
                           foc19_w2 == ""Unworried"" & foc19_w3 == ""Coping"" ~ ""Unworried to Coping"",
                           foc19_w2 == ""Unworried"" & foc19_w3 == ""Struggling"" ~ ""Unworried to Struggling"", 
                           foc19_w2 == ""Coping"" & foc19_w3 == ""Unworried"" ~ ""Coping to Unworried"",
                           foc19_w2 == ""Coping"" & foc19_w3 == ""Struggling"" ~ ""Coping to Struggling"",
                           foc19_w2 == ""Struggling"" & foc19_w3 == ""Unworried"" ~ ""Struggling to Unworried"",
                           foc19_w2 == ""Struggling"" & foc19_w3 == ""Coping"" ~ ""Struggling to Coping""), 
  stayedsame = case_when(
    grepl(""Stayed"", whochangedff) ~""stayed"", 
    grepl("" to "", whochangedff)~""changed"",
    TRUE ~ NA_character_))
change_tab <- data %>% 
  filter(!is.na(stayedsame)) %>% 
  group_by(stayedsame) %>% 
  summarise(n = sum(weight, na.rm = T)) %>% 
  mutate(perc = round(n/sum(n,na.rm = TRUE)*100,0)) 
"
"2","Grouping rowwise data frame strips rowwise nature"
