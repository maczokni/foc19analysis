"0","data %>% mutate(a_covidjob = as_factor(a_covidjob)) %>% 
  filter(!is.na(a_covidjob)) %>% 
  mutate(covjob = ifelse(a_covidjob == ""None of these"", ""Not key worker"", ""Key worker"" )) %>% 
  group_by(foc19_w3, covjob) %>% 
  summarise(n = sum(weight, na.rm = T)) %>% #sum weight 
  mutate(percent = n / sum(n), 
         w_covidjob = str_wrap(covjob, 25)) %>% 
  ggplot(., aes(x = foc19_w3, y = percent, fill = w_covidjob)) + 
  geom_bar(stat = ""identity"", position = ""stack"", col = ""black"") + 
  theme_minimal() + 
  scale_fill_manual(values=c(""#FFFFFF"", ""#000000""), name = ""Key worker"") + 
  scale_y_continuous(labels = scales::percent) + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + 
    xlab("""") + 
    ylab(""Percent"") + 
  labs(title = ""Are keyworkers in different worry groups?"")
"
"2","Factor `foc19_w3` contains implicit NA, consider using `forcats::fct_explicit_na`"
"2","Factor `foc19_w3` contains implicit NA, consider using `forcats::fct_explicit_na`"
